<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T2A23 Game Template</title>
    <style>
        body {
            background-repeat: no-repeat;
            background-size: cover;
            background-image: url('https://i.ibb.co/ggWykJY/cool-desktop-wallpaper-wallpapers-backgrounds-images-art-photos-pictures-free-best-1920x1080-coolwal.jpg');
            margin: 0;
            padding: 0;
        }
        h1, h6 {
            text-align: center;
            color: white;
        }
        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 999;
            left: 0; top: 0; width: 100%; height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
            padding-top: 100px;
        }
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 20px;
            border-radius: 5px;
            width: 80%;
            text-align: center;
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #45a049;
        }
        #autoBackgroundButton {
            margin: 10px;
        }
        img {
            position: absolute;
            width: 100px;
            height: 80px;
        }
    </style>
</head>
<body id="myBody">

    <h1>T2A23 Game Template by Aden</h1>
    <h6>Version 0.0.1</h6>

    <!-- Modal for losing message -->
    <div id="lossModal" class="modal">
        <div class="modal-content">
            <h2>You Lose</h2>
            <p>Please click below to proceed to the next page.</p>
            <button id="nextPage" onclick="goToNextPage()">Next Page</button>
        </div>
    </div>

    <img id="myImg01" src="https://i.ibb.co/NtcGP2L/greninja.jpg" alt="Greninja" style="top: 0; left: 50px;">
    <img id="myImg02" src="https://i.ibb.co/b612Tcx/charizard.jpg" alt="Charizard">

    <input type="button" id="autoBackgroundButton" value="Start Background Movement" onclick="toggleBackgroundMovement()">
    <input type="button" value="Fast Right Move" onclick="fastMoveRight()">

    <script>
        // Global movement flags
        let moveImg1 = { left: false, up: false, right: false, down: false };
        const speed = 5; // Speed for movement
        let moveBackground = false;
        let myGlobalX = 0;

        // Function to check collision between two elements
        function isColliding(elem1, elem2) {
            const rect1 = elem1.getBoundingClientRect();
            const rect2 = elem2.getBoundingClientRect();
            return !(rect1.right < rect2.left || rect1.left > rect2.right || 
                     rect1.bottom < rect2.top || rect1.top > rect2.bottom);
        }

        // Function to check for collisions
        function checkCollisions() {
            const img1 = document.getElementById('myImg01');
            const img2 = document.getElementById('myImg02');
            if (isColliding(img1, img2)) {
                showLossModal();
                img1.style.left = '50px'; // Reset position after a loss
            }
        }

        // Move images based on movement flags
        function moveImages() {
            const img1 = document.getElementById('myImg01');
            const img2 = document.getElementById('myImg02');
            if (moveImg1.left) img1.style.left = (parseInt(img1.style.left) - speed) + 'px';
            if (moveImg1.up) img1.style.top = (parseInt(img1.style.top) - speed) + 'px';
            if (moveImg1.right) img1.style.left = (parseInt(img1.style.left) + speed) + 'px';
            if (moveImg1.down) img1.style.top = (parseInt(img1.style.top) + speed) + 'px';

            // Move img2 (Charizard) towards img1 (Greninja)
            const deltaX = parseInt(img1.style.left) - parseInt(img2.style.left);
            const deltaY = parseInt(img1.style.top) - parseInt(img2.style.top);
            const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
            if (distance > 0) {
                img2.style.left = (parseInt(img2.style.left) + deltaX / distance * speed) + 'px';
                img2.style.top = (parseInt(img2.style.top) + deltaY / distance * speed) + 'px';
            }

            // Move background if flag is set
            if (moveBackground) {
                myGlobalX += 5;
                document.getElementById('myBody').style.backgroundPosition = myGlobalX + 'px 0px';
            }

            checkCollisions(); // Check for collisions
        }

        // Set interval for moving images and background
        setInterval(moveImages, 100);

        // Keydown event listener for movement
        document.addEventListener('keydown', (event) => {
            switch (event.key) {
                case 'ArrowLeft': moveImg1.left = true; break;
                case 'ArrowUp': moveImg1.up = true; break;
                case 'ArrowRight': moveImg1.right = true; break;
                case 'ArrowDown': moveImg1.down = true; break;
            }
        });

        // Keyup event listener to stop movement
        document.addEventListener('keyup', (event) => {
            switch (event.key) {
                case 'ArrowLeft': moveImg1.left = false; break;
                case 'ArrowUp': moveImg1.up = false; break;
                case 'ArrowRight': moveImg1.right = false; break;
                case 'ArrowDown': moveImg1.down = false; break;
            }
        });

        // Show loss modal
        function showLossModal() {
            document.getElementById('lossModal').style.display = 'block';
        }

        // Navigate to the next page
        function goToNextPage() {
            window.location.href = 't2a13-keydown.html'; // Replace with your next page URL
        }

        // Close modal when clicking outside of it
        window.onclick = (event) => {
            const modal = document.getElementById('lossModal');
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }

        // Initialize Charizard's position
        window.onload = () => {
            const img2 = document.getElementById('myImg02');
            img2.style.left = (window.innerWidth - 150) + 'px'; // start on right
            img2.style.top = (Math.random() * (window.innerHeight - 80)) + 'px'; // random vertical position
        };

        // Fast move right function
        function fastMoveRight() {
            const img1 = document.getElementById('myImg01');
            img1.style.left = (parseInt(img1.style.left) + 20) + 'px'; // Move Right Fast
            checkCollisions(); // Check for collisions
        }

        // Toggle background movement function
        function toggleBackgroundMovement() {
            moveBackground = !moveBackground;
            document.getElementById('autoBackgroundButton').value = moveBackground ? "Stop Background Movement" : "Start Background Movement";
        }
    </script>

</body>
</html>
