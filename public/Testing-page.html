<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animal Images, Math Problems & Pokémon Display</title>
    <style>
        .pokemon-stats { margin-top: 20px; }
        .stat { font-weight: bold; }
    </style>
</head>
<body>

<h1>Random Animal Images, Math Problems & Pokémon Display</h1>

<!-- Section for Animal Image Fetching -->
<h2>Random Animal Images</h2>
<label for="animalUrl">Enter a JSON returning URL:</label>
<input type="text" id="animalUrl" value="https://randomfox.ca/floof/">
<input type="button" value="Show Animal" onclick="fetchAnimalData()"><br><br>

<select id="animalOptions" size="1" onchange="updateAnimalUrl(this.value)">
    <option value="https://randomfox.ca/floof/">RandomFox</option>
    <option value="https://dog.ceo/api/breeds/image/random">Dog CEO</option>
    <option value="https://api.thecatapi.com/v1/images/search">Random Cat</option>
</select><br><br>

<div id="animalJson">Fetched JSON will appear here.</div>
<img id="animalImage" src="" alt="Fetched Image" style="display:none; margin-top: 20px; max-width: 100%; height: auto;"/>

<hr>

<!-- Section for Math Problems -->
<h2>Random Math Problems</h2>
<button onclick="generateMathProblem()">Generate Math Problem</button>
<div id="mathProblem" style="margin-top: 20px; font-size: 1.5em;"></div>
<div id="mathAnswer" style="margin-top: 20px; font-size: 1.5em;"></div>

<hr>

<!-- Section for Pokémon Display -->
<h2>Random Pokémon Display</h2>
<input type="button" value="Show Random Pokémon" onclick="fetchPokemonData()"><br><br>

<!-- New section for Pokémon ID search -->
<h3>Search Pokémon by ID</h3>
<input type="number" id="pokemonIdInput" placeholder="Enter Pokémon ID (1-1025)">
<input type="button" value="Search Pokémon" onclick="searchPokemonById()"><br><br>

<!-- Button to toggle shiny form -->
<input type="button" value="Toggle Shiny Form" onclick="toggleShinyForm()" style="display:none;" id="toggleShinyButton"><br><br>

<div id="pokemonJson">Fetched Pokémon data will appear here.</div>
<img id="pokemonImage" src="" alt="Fetched Pokémon" style="display:none; margin-top: 20px; max-width: 100%; height: auto;"/>
<div id="pokemonStats" class="pokemon-stats" style="display:none;"></div>

<script>
    let currentPokemon; // To store the current Pokémon data
    let isShiny = false; // To track if shiny form is to be displayed

    // Functionality for Animal Images
    async function fetchAnimalData() {
        const url = document.getElementById('animalUrl').value;
        try {
            const response = await fetch(url);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            const data = await response.json();
            document.getElementById('animalJson').innerHTML = JSON.stringify(data, null, 2);

            let imageUrl;
            if (data.image) {
                imageUrl = data.image;
            } else if (data.message) {
                imageUrl = data.message;
            } else if (data[0] && data[0].url) {
                imageUrl = data[0].url;
            }

            const animalImageElement = document.getElementById('animalImage');
            if (imageUrl) {
                animalImageElement.src = imageUrl; 
                animalImageElement.style.display = 'block'; 
            } else {
                animalImageElement.style.display = 'none';
            }
        } catch (error) {
            console.error('Fetch error:', error);
            document.getElementById('animalJson').textContent = 'Error fetching data: ' + error.message;
            document.getElementById('animalImage').style.display = 'none'; 
        }
    }

    function updateAnimalUrl(selectedUrl) {
        document.getElementById('animalUrl').value = selectedUrl;
        document.getElementById('animalJson').innerHTML = `Selected URL: ${selectedUrl}`;
    }

    // Functionality for Math Problems
    function generateMathProblem() {
        const num1 = Math.floor(Math.random() * 100);
        const num2 = Math.floor(Math.random() * 100);
        const operations = ['+', '-', '*', '/'];
        const operation = operations[Math.floor(Math.random() * operations.length)];

        const problem = `${num1} ${operation} ${num2}`;
        
        let answer;
        switch (operation) {
            case '+':
                answer = num1 + num2;
                break;
            case '-':
                answer = num1 - num2;
                break;
            case '*':
                answer = num1 * num2;
                break;
            case '/':
                answer = num2 !== 0 ? (num1 / num2).toFixed(2) : 'undefined (division by zero)';
                break;
        }

        document.getElementById('mathProblem').textContent = `Problem: ${problem}`;
        document.getElementById('mathAnswer').textContent = `Answer: ${answer}`;
    }

    // Functionality for Pokémon Display
    async function fetchPokemonData() {
        const randomId = Math.floor(Math.random() * 1025) + 1;
        const url = `https://pokeapi.co/api/v2/pokemon/${randomId}/`;

        try {
            const response = await fetch(url);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            currentPokemon = await response.json(); // Store current Pokémon data
            displayPokemon(currentPokemon);

        } catch (error) {
            console.error('Fetch error:', error);
            document.getElementById('pokemonJson').textContent = 'Error fetching data: ' + error.message;
            document.getElementById('pokemonImage').style.display = 'none'; 
            document.getElementById('pokemonStats').style.display = 'none'; 
        }
    }

    // New function to search Pokémon by ID
    async function searchPokemonById() {
        const id = document.getElementById('pokemonIdInput').value;

        if (id < 1 || id > 1025) {
            alert('Please enter a Pokémon ID between 1 and 1025.');
            return;
        }

        const url = `https://pokeapi.co/api/v2/pokemon/${id}/`;

        try {
            const response = await fetch(url);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            currentPokemon = await response.json(); // Store current Pokémon data
            displayPokemon(currentPokemon);

        } catch (error) {
            console.error('Fetch error:', error);
            document.getElementById('pokemonJson').textContent = 'Error fetching data: ' + error.message;
            document.getElementById('pokemonImage').style.display = 'none'; 
            document.getElementById('pokemonStats').style.display = 'none'; 
        }
    }

    // Function to display Pokémon data
    function displayPokemon(data) {
        document.getElementById('pokemonJson').innerHTML = `Fetched Pokémon ID: ${data.id}`;

        const imageUrl = isShiny ? data.sprites.front_shiny : data.sprites.front_default; 
        let statsHtml = `<div class="stat">Name: ${data.name.charAt(0).toUpperCase() + data.name.slice(1)}</div>`;
        statsHtml += `<div class="stat">Height: ${data.height} decimetres</div>`;
        statsHtml += `<div class="stat">Weight: ${data.weight} hectograms</div>`;
        statsHtml += `<div class="stat">Base Stats:</div>`;
        
        data.stats.forEach(stat => {
            statsHtml += `<div class="stat">${stat.stat.name.charAt(0).toUpperCase() + stat.stat.name.slice(1)}: ${stat.base_stat}</div>`;
        });

        const pokemonImageElement = document.getElementById('pokemonImage');
        if (imageUrl) {
            pokemonImageElement.src = imageUrl; 
            pokemonImageElement.style.display = 'block'; 
            
            document.getElementById('pokemonStats').innerHTML = statsHtml;
            document.getElementById('pokemonStats').style.display = 'block';
            document.getElementById('toggleShinyButton').style.display = 'inline'; // Show the toggle button
        } else {
            pokemonImageElement.style.display = 'none';
            document.getElementById('pokemonStats').style.display = 'none'; 
            document.getElementById('toggleShinyButton').style.display = 'none'; // Hide the toggle button if no image
        }
    }

    // Function to toggle shiny form
    function toggleShinyForm() {
        isShiny = !isShiny; // Toggle the shiny state
        if (currentPokemon) {
            displayPokemon(currentPokemon); // Redisplay the current Pokémon with the updated state
        }
    }
</script>

</body>
</html>
