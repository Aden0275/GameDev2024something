<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas Drawing Example</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }
        canvas {
            margin-top: 20px;
            border: 1px solid #000;
            cursor: crosshair; /* Changes cursor to crosshair for drawing */
        }
        .color-picker {
            margin: 10px;
        }
    </style>
</head>
<body>
    <h2 align="center">t2a08-canvas by Fred</h2>
    
    <div>
        <!-- Color Selection -->
        <label for="color">Choose Color:</label>
        <input type="color" id="color" class="color-picker" value="#000000">
        
        <!-- Line Width Selection -->
        <label for="lineWidth">Line Width:</label>
        <input type="range" id="lineWidth" class="color-picker" min="1" max="10" value="1">

        <!-- Drawing Options -->
        <input type="button" value="Draw Free" onclick="setDrawingMode('free');">
        <input type="button" value="Draw Rectangle" onclick="setDrawingMode('rectangle');">
        <input type="button" value="Draw Circle" onclick="setDrawingMode('circle');">
        <input type="button" value="Draw Triangle" onclick="setDrawingMode('triangle');"><br><br>

        <!-- Button to clear all drawings -->
        <input type="button" value="Clear all" onclick="clearAll();"><br><br>
    </div>

    <canvas id="myCoolTag" width="1000" height="600"></canvas>

    <script>
        // Set up global variables
        let myCanvas = document.getElementById('myCoolTag');
        let myContext = myCanvas.getContext('2d');

        // Variables for drawing with the mouse
        let drawing = false;
        let lastX = 0;
        let lastY = 0;
        let drawingMode = 'free'; // Default mode is free drawing
        let currentColor = '#000000'; // Default color
        let currentLineWidth = 1; // Default line width

        // Mouse event listeners
        myCanvas.addEventListener('mousedown', (e) => {
            drawing = true;
            [lastX, lastY] = getMousePos(e);
        });

        myCanvas.addEventListener('mousemove', (e) => {
            if (drawing) {
                const [x, y] = getMousePos(e);
                if (drawingMode === 'free') {
                    drawLine(lastX, lastY, x, y);
                } else if (drawingMode === 'rectangle') {
                    drawRectangle(lastX, lastY, x, y);
                } else if (drawingMode === 'circle') {
                    drawCircle(lastX, lastY, x, y);
                } else if (drawingMode === 'triangle') {
                    drawTriangle(lastX, lastY, x, y);
                }
                lastX = x;
                lastY = y;
            }
        });

        myCanvas.addEventListener('mouseup', () => {
            drawing = false;
            if (drawingMode !== 'free') {
                finalizeShape();
            }
        });

        myCanvas.addEventListener('mouseout', () => {
            drawing = false; // Stop drawing when mouse leaves canvas
        });

        document.getElementById('color').addEventListener('input', (e) => {
            currentColor = e.target.value; // Update current color
        });

        document.getElementById('lineWidth').addEventListener('input', (e) => {
            currentLineWidth = e.target.value; // Update current line width
        });

        function getMousePos(evt) {
            const rect = myCanvas.getBoundingClientRect();
            const x = evt.clientX - rect.left; // Get mouse x position relative to canvas
            const y = evt.clientY - rect.top;  // Get mouse y position relative to canvas
            return [x, y];
        }

        function drawLine(fromX, fromY, toX, toY) {
            myContext.strokeStyle = currentColor;
            myContext.lineWidth = currentLineWidth;
            myContext.beginPath();
            myContext.moveTo(fromX, fromY);
            myContext.lineTo(toX, toY);
            myContext.stroke();
        }

        function finalizeShape() {
            myContext.strokeStyle = currentColor;
            myContext.lineWidth = currentLineWidth;
            myContext.stroke();
        }

        function setDrawingMode(mode) {
            drawingMode = mode;
        }

        function drawRectangle(fromX, fromY, toX, toY) {
            myContext.strokeStyle = currentColor;
            myContext.lineWidth = currentLineWidth;
            myContext.beginPath();
            myContext.rect(fromX, fromY, toX - fromX, toY - fromY);
            myContext.stroke();
        }

        function drawCircle(fromX, fromY, toX, toY) {
            const radius = Math.sqrt(Math.pow(toX - fromX, 2) + Math.pow(toY - fromY, 2));
            myContext.strokeStyle = currentColor;
            myContext.lineWidth = currentLineWidth;
            myContext.beginPath();
            myContext.arc(fromX, fromY, radius, 0, Math.PI * 2);
            myContext.stroke();
        }

        function drawTriangle(fromX, fromY, toX, toY) {
            myContext.strokeStyle = currentColor;
            myContext.lineWidth = currentLineWidth;
            myContext.beginPath();
            myContext.moveTo(fromX, fromY); // Start point
            myContext.lineTo(toX, toY); // Base right point
            myContext.lineTo(fromX - (toX - fromX), toY); // Base left point
            myContext.closePath(); // Connect to the start point
            myContext.stroke();
        }

        function clearAll() {
            myContext.clearRect(0, 0, myCanvas.width, myCanvas.height);
        }
    </script>
</body>
</html>
